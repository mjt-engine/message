{"version":3,"file":"sendMessageError.js","sourceRoot":"","sources":["../src/sendMessageError.ts"],"names":[],"mappings":"AAAA,OAAO,EAAE,KAAK,EAAE,MAAM,kBAAkB,CAAC;AACzC,OAAO,EAAE,MAAM,EAAE,MAAM,mBAAmB,CAAC;AAC3C,OAAO,EAAE,SAAS,EAAE,MAAM,oBAAoB,CAAC;AAC/C,OAAO,EAAY,OAAO,IAAI,WAAW,EAAE,MAAM,SAAS,CAAC;AAE3D,MAAM,CAAC,MAAM,gBAAgB,GAC3B,CAAC,OAAY,EAAE,EAAE,CACjB,KAAK,EACH,KAAc,EACd,UAIK,EAAE,EACP,EAAE;IACF,MAAM,WAAW,GAAG,MAAM,CAAC,kBAAkB,CAAC;QAC5C,KAAK;QACL,KAAK,EAAE,CAAC,OAAO,CAAC,OAAO,CAAC;KACzB,CAAC,CAAC;IACH,MAAM,eAAe,GAAG,WAAW,EAAE,CAAC;IACtC,IAAI,SAAS,CAAC,OAAO,CAAC,OAAO,CAAC,EAAE,CAAC;QAC/B,KAAK,MAAM,CAAC,GAAG,EAAE,KAAK,CAAC,IAAI,MAAM,CAAC,OAAO,CAAC,OAAO,CAAC,OAAO,CAAC,EAAE,CAAC;YAC3D,eAAe,CAAC,GAAG,CAAC,GAAG,EAAE,KAAK,CAAC,CAAC;QAClC,CAAC;IACH,CAAC;IACD,OAAO,CAAC,OAAO,CAAC,KAAK,CAAC,SAAS,CAAC,EAAE,KAAK,EAAE,WAAW,EAAE,CAAC,EAAE;QACvD,OAAO,EAAE,eAAe;KACzB,CAAC,CAAC;AACL,CAAC,CAAC","sourcesContent":["import { Bytes } from \"@mjt-engine/byte\";\nimport { Errors } from \"@mjt-engine/error\";\nimport { isDefined } from \"@mjt-engine/object\";\nimport { type Msg, headers as natsHeaders } from \"nats.ws\";\n\nexport const sendMessageError =\n  (message: Msg) =>\n  async (\n    error: unknown,\n    options: Partial<{\n      code: number;\n      codeDescription: string;\n      headers: Record<string, string>;\n    }> = {}\n  ) => {\n    const errorDetail = Errors.errorToErrorDetail({\n      error,\n      extra: [message.subject],\n    });\n    const responseHeaders = natsHeaders();\n    if (isDefined(options.headers)) {\n      for (const [key, value] of Object.entries(options.headers)) {\n        responseHeaders.set(key, value);\n      }\n    }\n    message.respond(Bytes.toMsgPack({ error: errorDetail }), {\n      headers: responseHeaders,\n    });\n  };\n"]}